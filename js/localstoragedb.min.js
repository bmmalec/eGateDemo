function localStorageDB(n,t){function g(){delete e[l];i=null}function nt(){var n=0;for(var t in i.tables)i.tables.hasOwnProperty(t)&&n++;return n}function tt(n){return i.tables[n].fields}function p(n){return i.tables[n]?!0:!1}function u(n){p(n)||r("The table '"+n+"' does not exist.")}function it(n,t){var r=!1,u=i.tables[n].fields;for(var f in u)if(u[f]==t){r=!0;break}return r}function rt(n,t){i.tables[n]={fields:t,auto_increment:1};i.data[n]={}}function ut(n){delete i.tables[n];delete i.data[n]}function ft(n){i.tables[n].auto_increment=1;i.data[n]={}}function w(n,t,r){var u,f;if(i.tables[n].fields=i.tables[n].fields.concat(t),typeof r!="undefined")for(u in i.data[n])if(i.data[n].hasOwnProperty(u))for(f in t)i.data[n][u][t[f]]=typeof r=="object"?r[t[f]]:r}function et(n){var t=0;for(var r in i.data[n])i.data[n].hasOwnProperty(r)&&t++;return t}function a(n,t){return t.ID=i.tables[n].auto_increment,i.data[n][i.tables[n].auto_increment]=t,i.tables[n].auto_increment++,t.ID}function ot(n,t){for(var u=null,f=[],e=null,r=0;r<t.length;r++)u=t[r],e=i.data[n][u],f.push(v(e));return f}function s(n,t,r,u){var s=[],e=!1,h=null,o,f;start_n=0;for(o in i.data[n])if(i.data[n].hasOwnProperty(o)){h=i.data[n][o];e=!0;for(f in t)if(t.hasOwnProperty(f))if(typeof t[f]=="string"){if(h[f].toString().toLowerCase()!=t[f].toString().toLowerCase()){e=!1;break}}else if(h[f]!=t[f]){e=!1;break}if(e){if(typeof u=="number"&&start_n<u){start_n++;continue}s.push(o)}if(s.length==r)break}return s}function h(n,t,r,u){var f=[],o=null,s=0;for(var e in i.data[n])if(i.data[n].hasOwnProperty(e)){if(o=i.data[n][e],t(v(o))==!0){if(typeof u=="number"&&s<u){s++;continue}f.push(e)}if(f.length==r)break}return f}function c(n,t,r){var u=[],f=0;for(var e in i.data[n])if(i.data[n].hasOwnProperty(e)){if(typeof r=="number"&&f<r){f++;continue}if(u.push(e),u.length==t)break}return u}function st(n,t){for(var r=0;r<t.length;r++)i.data[n].hasOwnProperty(t[r])&&delete i.data[n][t[r]];return t.length}function b(n,t,r){for(var u,h,e,f="",c=0,s=0;s<t.length;s++)if(f=t[s],u=r(v(i.data[n][f])),u){delete u.ID;h=i.data[n][f];for(e in u)u.hasOwnProperty(e)&&(h[e]=u[e]);i.data[n][f]=o(n,h);c++}return c}function k(){try{return e[l]=JSON.stringify(i),!0}catch(n){return!1}}function ht(){return JSON.stringify(i)}function r(n){throw new Error(n);}function v(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function f(n){return n.toString().match(/[^a-z_0-9]/ig)?!1:!0}function o(n,t){for(var r="",f={},u=0;u<i.tables[n].fields.length;u++)r=i.tables[n].fields[u],t[r]!==null&&t[r]!==undefined&&(f[r]=t[r]);return f}function d(n,t){for(var r="",f={},u=0;u<i.tables[n].fields.length;u++)r=i.tables[n].fields[u],f[r]=t[r]===null||t[r]===undefined?null:t[r];return f}var l="db_"+n,y=!1,i=null,e;try{e=t==sessionStorage?sessionStorage:localStorage}catch(ct){e=t}return i=e[l],i&&(i=JSON.parse(i))&&i.tables&&i.data||(f(n)?(i={tables:{},data:{}},k(),y=!0):r("The name '"+n+"' contains invalid characters.")),{commit:function(){return k()},isNew:function(){return y},drop:function(){g()},serialize:function(){return ht()},tableExists:function(n){return p(n)},tableFields:function(n){return tt(n)},tableCount:function(){return nt()},columnExists:function(n,t){return it(n,t)},createTable:function(n,t){var s=!1,e,u,i,o;if(f(n))if(this.tableExists(n))r("The table name '"+n+"' already exists.");else{for(e=!0,i=0;i<t.length;i++)if(!f(t[i])){e=!1;break}if(e){for(u={},i=0;i<t.length;i++)u[t[i]]=!0;delete u.ID;t=["ID"];for(o in u)u.hasOwnProperty(o)&&t.push(o);rt(n,t);s=!0}else r("One or more field names in the table definition contains invalid characters.")}else r("The database name '"+n+"' contains invalid characters.");return s},createTableWithData:function(n,t){var u,i;if((typeof t!="object"||!t.length||t.length<1)&&r("Data supplied isn't in object form. Example: [{k:v,k:v},{k:v,k:v} ..]"),u=Object.keys(t[0]),this.createTable(n,u)){for(this.commit(),i=0;i<t.length;i++)a(n,t[i])||r("Failed to insert record: ["+JSON.stringify(t[i])+"]");this.commit()}return!0},dropTable:function(n){u(n);ut(n)},truncate:function(n){u(n);ft(n)},alterTable:function(n,t,i){var o=!1,s,e,u,h,c;if(f(n))if(typeof t=="object"){for(s=!0,u=0;u<t.length;u++)if(!f(t[u])){s=!1;break}if(s){for(e={},u=0;u<t.length;u++)e[t[u]]=!0;delete e.ID;t=[];for(h in e)e.hasOwnProperty(h)&&t.push(h);w(n,t,i);o=!0}else r("One or more field names in the table definition contains invalid characters.")}else typeof t=="string"&&(f(t)?(c=[],c.push(t),w(n,c,i),o=!0):r("One or more field names in the table definition contains invalid characters."));else r("The database name '"+n+"' contains invalid characters.");return o},rowCount:function(n){return u(n),et(n)},insert:function(n,t){return u(n),a(n,d(n,t))},insertOrUpdate:function(n,t,i){var r,f,e;if(u(n),r=[],t?typeof t=="object"?r=s(n,o(n,t)):typeof t=="function"&&(r=h(n,t)):r=c(n),r.length==0)return a(n,d(n,i));for(f=[],e=0;e<r.length;e++)b(n,r,function(n){return f.push(n.ID),i});return f},update:function(n,t,i){u(n);var r=[];return t?typeof t=="object"?r=s(n,o(n,t)):typeof t=="function"&&(r=h(n,t)):r=c(n),b(n,r,i)},query:function(n,t,i,r){u(n);var f=[];return t?typeof t=="object"?f=s(n,o(n,t),i,r):typeof t=="function"&&(f=h(n,t,i,r)):f=c(n,i,r),ot(n,f,i)},deleteRows:function(n,t){u(n);var i=[];return t?typeof t=="object"?i=s(n,o(n,t)):typeof t=="function"&&(i=h(n,t)):i=c(n),st(n,i)}}}
/*
//# sourceMappingURL=localstoragedb.min.js.map
*/